# Project10 实验报告：the application of this deduce technique in Ethereum with ECDSA

## ECDSA介绍

### 内容介绍

ECDSA（Elliptic Curve Digital Signature Algorithm）是一种基于椭圆曲线的数字签名算法，是一种非对称密码学算法。椭圆曲线数字签名算法（ECDSA）使用椭圆曲线密码（ECC）对数字签名算法（DSA）的模拟，依赖于椭圆曲线上的数学性质，特别是离散对数问题的难解性。

椭圆曲线离散对数问题可以理解为，在椭圆曲线上，给定一个点P和整数k，计算点Q，使得kP = Q。这个问题在一定条件下是难以解决的，因为计算过程无法简单地逆转。离散对数问题的难解性是ECDSA安全性的基础。

椭圆曲线离散对数问题没有亚指数时间的解决方法。因此椭圆曲线密码的单位比特强度要高于其他公钥体制。数字签名算法（DSA）的安全性基于素域上的离散对数问题。

ECDSA的优点在于它提供了高效且安全的数字签名方案，相比传统的RSA算法，它所需的密钥尺寸更小，运算速度更快，适用于各种资源受限的环境。然而，它也需要谨慎地选择合适的椭圆曲线和参数，以确保安全性和抵抗潜在的攻击。

### 主要流程

#### 签名过程如下：
1、选择一条椭圆曲线Ep(a,b)，和基点G；
2、选择私有密钥k（k<n，n为G的阶），利用基点G计算公开密钥K=kG；
3、产生一个随机整数r（r<n），计算点R=rG；
4、将原数据和点R的坐标值x,y作为参数，计算SHA1做为hash，即Hash=SHA1(原数据,x,y)；
5、计算s≡r - Hash * k (mod n)
6、r和s做为签名值，如果r和s其中一个为0，重新从第3步开始执行
#### 验证过程如下：
1、接受方在收到消息(m)和签名值(r,s)后，对于接收到的数据和签名(r, s)，首先验证r和s是否在合理范围内，并且不是无穷远点，然后将数据进行哈希运算得到哈希值。接下来，计算w=s^-1 mod n，u1 = hash * w mod n，u2 = r * w mod n，并计算点R' = u1 * G + u2 * Q。如果R'的x坐标等于r，则签名有效。
2、计算：sG+H(m)P=(x1,y1), r1≡ x1 mod p。
3、验证等式：r1 ≡ r mod p。
4、如果等式成立，接受签名，否则签名无效。

ECDSA用于生成和验证数字签名，确保数据的完整性和来源认证。它被用于确保电子文档、软件和通信的安全。许多加密货币（例如Bitcoin）使用ECDSA来实现交易签名，保障交易的安全性和防止伪造。ECDSA用于生成和验证数字证书，以确保公钥的合法性和安全性，是HTTPS等安全通信的基础。在数字身份认证系统中，ECDSA可以用于验证用户身份，实现安全的身份验证。区块链中的智能合约和交易也经常使用ECDSA进行签名和验证。

## ECDSA在以太坊中的应用

包含数字签名、以太坊账户地址生成、智能合约和代币交易

### 交易签名

在以太坊中，所有交易都需要进行签名，以证明交易的合法性和确保安全性。ECDSA用于生成交易的数字签名，验证交易发送者的身份，并确保交易内容未被篡改。首先，交易发送者使用私钥对交易数据进行哈希，然后使用ECDSA签名算法对该哈希值进行签名。这个签名是一个数字值，是私钥对交易数据的数学运算结果。随后，这个数字签名会随交易一起被广播到整个网络。当其他节点接收到这个交易时，它们可以使用发送者的公钥对签名进行验证，以确认交易确实是由发送者发起的，并且交易内容没有被篡改。


### 地址生成

以太坊的账户地址是由公钥通过哈希运算得到的。ECDSA被用于生成以太坊账户的公私钥对，其中公钥用于生成地址，私钥用于签署交易。
首先，用户生成一个公私钥对，其中公钥是一个椭圆曲线上的点，私钥是一个随机数。接着，将公钥进行哈希运算，生成一个地址，该地址就是用户的以太坊账户地址。ECDSA被用于生成这个公私钥对。


### 智能合约

以太坊中的智能合约是自动执行的计算机程序，但在执行前必须先验证它们的合法性。智能合约可以包含ECDSA签名，用于验证外部调用的合法性。当智能合约接收到外部调用时，它会使用ECDSA签名算法对接收到的签名进行验证，以确保只有被授权的实体可以执行该智能合约。


### 代币交易

以太坊上的代币交易通常也需要进行签名。代币合约可以在交易过程中验证交易发送者的签名，确保代币的持有者授权的转账行为合法有效。只有持有者能够正确地使用私钥进行签名，从而转移代币。使用ECDSA签名来确保代币持有者授权的转账行为合法有效。

### 身份验证

以太坊中的身份验证很大程度上依赖于ECDSA签名。通过验证签名，可以确定交易发送者或智能合约调用者的身份。

总的来说，ECDSA在以太坊中扮演着数字签名和身份验证的重要角色，为以太坊的安全性和可信性提供了关键的保障。它确保了交易和智能合约的合法性，并为用户提供了安全可靠的身份验证机制。ECDSA签名保护了以太坊的用户免受欺诈和恶意行为，使整个网络能够可靠地运行。

## 测试代码
~~~
import ecdsa
import random
import hashlib
gen = ecdsa.NIST256p.generator
order = gen.order()
# 生成私钥d_A
d_A = random.randrange(1,order-1)
# 生成公私钥对象
public_key = ecdsa.ecdsa.Public_key(gen,gen * d_A)
private_key = ecdsa.ecdsa.Private_key(public_key,d_A)
message = "ecdsa"
print("消息为：",message)
m = int(hashlib.sha1(message.encode("utf8")).hexdigest(),16)
# 临时密钥
k = random.randrange(1,order-1)
# 签名
signature = private_key.sign(m,k)
r = signature.r
s = signature.s
print("签名为：")
print("r=",r)
print("s=",s)
~~~

## 运行结果
![image](https://github.com/chunqingshaonv/homework-group-79/assets/139244994/06c89b77-c9a9-4586-a4d8-c4f0bc2f5399)

